<!-- Header -->
<header class="header">
  <div class="header-content">
    <button class="burger-menu" (click)="toggleMenu()" [class.active]="isMenuOpen">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <h1 class="logo">Paperless</h1>
    <button class="add-btn" (click)="addDocument()" [disabled]="isUploading">
      <span class="plus-icon" *ngIf="!isUploading">+</span>
      <span class="loading-spinner" *ngIf="isUploading"></span>
      {{ isUploading ? 'Uploading...' : 'Add Document' }}
    </button>
    
    <input type="file" 
           id="fileInput" 
           accept=".pdf" 
           (change)="onFileSelected($event)"
           style="display: none;">
  </div>
</header>

<!-- Upload Status Banner -->
<div class="upload-status" *ngIf="uploadStatus" [class.success]="uploadStatus.includes('success')" [class.error]="uploadStatus.includes('failed')">
  {{ uploadStatus }}
</div>

<!-- Side Menu -->
<nav class="side-menu" [class.open]="isMenuOpen">
  <div class="menu-content">
    <a href="#" class="menu-item" (click)="searchDocuments()">
      <span class="icon">ğŸ”</span>
      Search
    </a>
    <a href="#" class="menu-item" (click)="showAllDocuments()">
      <span class="icon">ğŸ“</span>
      All Documents
    </a>
    <a href="#" class="menu-item">
      <span class="icon">ğŸ·ï¸</span>
      Tags
    </a>
    <a href="#" class="menu-item">
      <span class="icon">ğŸ“Š</span>
      Statistics
    </a>
    <div class="menu-separator"></div>
    <a href="#" class="menu-item" (click)="viewSettings()">
      <span class="icon">âš™ï¸</span>
      Settings
    </a>
    <a href="#" class="menu-item" (click)="testApi()">
      <span class="icon">ğŸ”§</span>
      Test API
    </a>
  </div>
</nav>

<!-- Overlay for mobile menu -->
<div class="overlay" [class.active]="isMenuOpen" (click)="toggleMenu()"></div>

<!-- Main Content -->
<main class="main-content" [class.menu-open]="isMenuOpen">
  <div class="content-area">
    
    <!-- Home View -->
    <div *ngIf="currentView === 'home'">
      <div class="welcome-section">
        <h2>Welcome to Paperless</h2>
        <p>Manage your documents digitally and efficiently.</p>
        
        <!-- File Drop Zone -->
        <div class="drop-zone" 
             (dragover)="onDragOver($event)" 
             (dragleave)="onDragLeave($event)"
             (drop)="onFileDrop($event)"
             [class.drag-over]="isDragOver">
          <div class="drop-zone-content">
            <div class="drop-icon">ğŸ“</div>
            <p><strong>Drop PDF files here</strong></p>
            <p>or click "Add Document" to browse</p>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <button class="action-card" (click)="addDocument()">
          <div class="card-icon">ğŸ“„</div>
          <h3>Upload Document</h3>
          <p>Add a new document to your collection</p>
        </button>
        
        <button class="action-card" (click)="showAllDocuments()">
          <div class="card-icon">ğŸ“Š</div>
          <h3>View All Documents</h3>
          <p>Browse your entire document collection</p>
        </button>
      </div>

      <!-- API Test Section (for development) -->
      <div class="api-test-section">
        <button class="test-btn" (click)="testApi()">Test API Connection</button>
        <pre class="api-result" *ngIf="result">{{ result | json }}</pre>
      </div>
    </div>

    <!-- Documents View -->
    <div *ngIf="currentView === 'documents'">
      <div class="documents-header">
        <div class="documents-title">
          <button class="back-btn" (click)="showHome()">â† Back</button>
          <h2>Documents</h2>
        </div>
        
        <!-- Search Bar -->
        <div class="search-container">
          <input type="text" 
                 class="search-input"
                 placeholder="Search by filename or content..."
                 [(ngModel)]="searchQuery"
                 (input)="onSearchInput($event)">
          <span class="search-icon">ğŸ”</span>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoadingDocuments" class="loading-state">
        <div class="loading-spinner-large"></div>
        <p>Loading documents...</p>
      </div>

      <!-- Documents List -->
      <div *ngIf="!isLoadingDocuments" class="documents-grid">
        <div *ngIf="filteredDocuments.length === 0 && documents.length === 0" class="empty-state">
          <div class="empty-icon">ğŸ“„</div>
          <h3>No documents found</h3>
          <p>Upload your first document to get started</p>
          <button class="upload-btn" (click)="addDocument()">Upload Document</button>
        </div>

        <div *ngIf="filteredDocuments.length === 0 && documents.length > 0" class="no-results">
          <div class="empty-icon">ğŸ”</div>
          <h3>No results found</h3>
          <p>Try adjusting your search terms</p>
        </div>

        <div *ngFor="let doc of filteredDocuments"
             class="document-card"
             [class.selected]="selectedDocument?.id === doc.id"
             (click)="selectDocument(doc)">
          <div class="document-header">
            <div class="document-icon">ğŸ“„</div>
            <div class="document-info">
              <h3 class="document-title">{{ doc.fileName }}</h3>
              <p class="document-author">PDF Document</p>
              <p class="document-meta">
                {{ formatDate(doc.createdAt) }}
              </p>
            </div>
          </div>

          <div class="document-actions">
            <button class="action-btn download"
                    (click)="$event.stopPropagation(); downloadDocument(doc)"
                    title="Download">
              â¬‡ï¸
            </button>
            <button class="action-btn delete"
                    (click)="$event.stopPropagation(); deleteDocument(doc)"
                    title="Delete">
              ğŸ—‘ï¸
            </button>
            <div class="tag-badge" *ngIf="doc.tagName" [ngClass]="doc.tagClass" title="Document tag">
              {{ doc.tagName }}
            </div>
          </div>

          <!-- Document Summary -->
          <div class="doc-summary" *ngIf="doc">
            <div *ngIf="doc.summary; else summaryPending" class="summary-text fade-in">
              <strong>Summary:</strong>
              <div [innerText]="doc.summary"></div>
            </div>
            <ng-template #summaryPending>
              <div class="summary-pending loading-pulse" *ngIf="!doc.summary">
                <em>Summary is being generated...</em>
              </div>
            </ng-template>
          </div>

          <!-- Change Summary (shown when this card is selected) -->
          <div class="change-summary"
               *ngIf="selectedDocument?.id === doc.id && doc.changeSummary">
            <div class="change-summary-header">
              <strong>Changes (v{{ doc.versionNumber || doc.currentVersionId || '?' }}):</strong>
              <span *ngIf="doc.sizeBytes" class="change-summary-meta">
                â€¢ {{ formatBytes(doc.sizeBytes) }}
              </span>
            </div>
            <div class="change-summary-body"
                 [innerHTML]="formatMarkdown(doc.changeSummary)">
            </div>
          </div>

          <!-- Version History Button -->
          <div class="version-actions" *ngIf="selectedDocument?.id === doc.id">
            <button class="version-toggle-btn" (click)="$event.stopPropagation(); toggleVersionHistory()">
              {{ showVersionHistory ? 'â–¼' : 'â–¶' }} Version History
              <span class="version-count" *ngIf="doc.versions && doc.versions.length > 0">
                ({{ doc.versions!.length }})
              </span>
            </button>
          </div>

          <!-- Version History List -->
          <div class="version-history" *ngIf="selectedDocument?.id === doc.id && showVersionHistory">
            <div class="version-loading" *ngIf="!doc.allVersionsLoaded">
              <em>Loading versions...</em>
            </div>
            
            <div class="version-list" *ngIf="doc.allVersionsLoaded && doc.versions">
              <div *ngFor="let version of doc.versions"
                   class="version-item"
                   [class.current-version]="version.id === doc.currentVersionId"
                   [class.selected-version]="selectedVersion?.id === version.id"
                   (click)="$event.stopPropagation(); selectVersion(version)">
                
                <div class="version-header">
                  <div class="version-info">
                    <strong>Version {{ version.versionNumber }}</strong>
                    <span class="version-badge" *ngIf="version.id === doc.currentVersionId">Current</span>
                  </div>
                  <span class="version-size">{{ formatBytes(version.sizeBytes) }}</span>
                </div>

                <div class="version-summary" *ngIf="version.changeSummary">
                  <div class="version-summary-label">Changes:</div>
                  <div class="version-summary-text">{{ version.changeSummary }}</div>
                </div>

                <div class="version-actions-row">
                  <button class="version-action-btn download"
                          (click)="$event.stopPropagation(); downloadVersion(version.id!, version.versionNumber)"
                          title="Download this version">
                    â¬‡ï¸ Download
                  </button>
                  
                  <button class="version-action-btn set-current"
                          *ngIf="version.id !== doc.currentVersionId"
                          (click)="$event.stopPropagation(); setCurrentVersion(doc.id, version.id!)"
                          title="Set as current version">
                    âœ“ Set Current
                  </button>
                  
                  <button class="version-action-btn view-ocr"
                          (click)="$event.stopPropagation(); getVersionOcr(version.id!)"
                          title="View OCR text">
                    ğŸ“ OCR
                  </button>
                </div>
              </div>

              <div class="no-versions" *ngIf="doc.versions.length === 0">
                No version history available.
              </div>
            </div>
          </div>

        </div>

        <!-- ...existing code... -->